{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '46887130-d3f8e3821f1ed34df6d7a3ffd';\nconst BASE_URL = 'https://pixabay.com/api/';\n\n\nexport async function searchImages(query, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: 15,\n      },\n    });\n    const { hits, totalHits } = response.data;\n    return { images: hits, totalHits };\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error; \n  }\n}\n\nexport async function loadMoreImages(query, page) {\n  return await searchImages(query, page); \n}\n","export function generateGalleryMarkup(images) {\n  return images\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n          </a>\n          <div class=\"info\">\n            <div class=\"info__item\">\n              <p class=\"title\">Likes</p>\n              <p class=\"value\">${likes}</p>\n            </div>\n            <div class=\"info__item\">\n              <p class=\"title\">Views</p>\n              <p class=\"value\">${views}</p>\n            </div>\n            <div class=\"info__item\">\n              <p class=\"title\">Comments</p>\n              <p class=\"value\">${comments}</p>\n            </div>\n            <div class=\"info__item\">\n              <p class=\"title\">Downloads</p>\n              <p class=\"value\">${downloads}</p>\n            </div>\n          </div>\n        </li>\n      `\n    ).join(\"\");\n}\n\nexport function startLoader() {\n  const loaderContainer = document.querySelector('.loader__container');\n  loaderContainer.classList.add('active');\n}\n\nexport function stopLoader() {\n  const loaderContainer = document.querySelector('.loader__container');\n  loaderContainer.classList.remove('active');\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport { searchImages, loadMoreImages } from \"./js/pixabay-api\";\nimport { generateGalleryMarkup, startLoader, stopLoader } from \"./js/render-functions\";\n\nconst searchForm = document.querySelector('.search-form');\nconst searchInput = searchForm.querySelector('input[type=search]');\nconst galleryList = document.querySelector('.gallery__list');\nconst loadMoreButton = document.querySelector('.load-more-button');\nconst loaderContainer = document.querySelector('.loader__container');\n\nlet lightbox;\nlet page = 1;\nlet totalHits = 0;\nlet loadedHits = 0;\nlet query = '';\n\nsearchForm.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n  query = searchInput.value.trim();\n\n  if (query === '') {\n    iziToast.error({\n      title: 'Error',\n      message: 'Fill search input!',\n      position: 'topRight'\n    });\n    return;\n  }\n\n  \n  galleryList.innerHTML = '';\n  page = 1;\n  loadedHits = 0;\n  loadMoreButton.style.display = 'none';\n  loaderContainer.style.display = 'none';\n\n  try {\n    const { images, totalHits: total } = await searchImages(query, page);\n    totalHits = total;\n    loadedHits += images.length;\n\n    if (images.length === 0) {\n      iziToast.info({\n        title: 'Info',\n        message: 'No images found.',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    galleryList.innerHTML = generateGalleryMarkup(images);\n\n  \n    if (lightbox) {\n      lightbox.refresh();\n    } else {\n      lightbox = new SimpleLightbox('.gallery__list a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n      });\n    }\n\n    searchInput.value = '';\n\n    \n    if (loadedHits < totalHits) {\n      loadMoreButton.style.display = 'block';\n    } else {\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong with the search request.',\n      position: 'topRight',\n    });\n  }\n});\n\n\nloadMoreButton.addEventListener(\"click\", async (event) => {\n  event.preventDefault();\n  page += 1;\n\n  \n  loaderContainer.style.display = 'block';\n\n  try {\n    const { images } = await loadMoreImages(query, page);\n    loadedHits += images.length;\n    galleryList.insertAdjacentHTML('beforeend', generateGalleryMarkup(images));\n\n    \n    lightbox.refresh();\n    smoothScrollToNewImages();\n\n    if (loadedHits >= totalHits) {\n      loadMoreButton.style.display = 'none';\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load more images.',\n      position: 'topRight',\n    });\n  } finally {\n    loaderContainer.style.display = 'none';\n  }\n});\n\n\nfunction smoothScrollToNewImages() {\n  const { height: cardHeight } = galleryList.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["API_KEY","BASE_URL","searchImages","query","page","response","axios","hits","totalHits","error","loadMoreImages","generateGalleryMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","searchInput","galleryList","loadMoreButton","loaderContainer","lightbox","loadedHits","event","iziToast","total","SimpleLightbox","smoothScrollToNewImages","cardHeight"],"mappings":"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"}