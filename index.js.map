{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '46887130-d3f8e3821f1ed34df6d7a3ffd';\nconst BASE_URL = 'https://pixabay.com/api/';\n\n\nexport async function searchImages(query, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: 15,\n      },\n    });\n    const { hits, totalHits } = response.data;\n    return { images: hits, totalHits };\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error; \n  }\n}\n\nexport async function loadMoreImages(query, page) {\n  return await searchImages(query, page); \n}\n","export function generateGalleryMarkup(images) {\n  return images\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n          </a>\n          <div class=\"info\">\n            <div class=\"info__item\">\n              <p class=\"title\">Likes</p>\n              <p class=\"value\">${likes}</p>\n            </div>\n            <div class=\"info__item\">\n              <p class=\"title\">Views</p>\n              <p class=\"value\">${views}</p>\n            </div>\n            <div class=\"info__item\">\n              <p class=\"title\">Comments</p>\n              <p class=\"value\">${comments}</p>\n            </div>\n            <div class=\"info__item\">\n              <p class=\"title\">Downloads</p>\n              <p class=\"value\">${downloads}</p>\n            </div>\n          </div>\n        </li>\n      `\n    ).join(\"\");\n}\n\nexport function startLoader() {\n  const loaderContainer = document.querySelector('.loader__container');\n  loaderContainer.classList.add('active');\n}\n\nexport function stopLoader() {\n  const loaderContainer = document.querySelector('.loader__container');\n  loaderContainer.classList.remove('active');\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { searchImages, loadMoreImages } from \"./js/pixabay-api\";\nimport { generateGalleryMarkup, startLoader, stopLoader } from \"./js/render-functions\";\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const searchForm = document.querySelector('.search-form');\n  const searchInput = searchForm.querySelector('input[type=search]');\n  const galleryList = document.querySelector('.gallery__list');\n  const loadMoreButton = document.querySelector('.load-more-button');\n\n  let lightbox;\n  let page = 1;\n  let totalHits = 0;\n  let loadedHits = 0;\n  let query = '';\n\n  const handleSearchImages = async () => {\n    startLoader();  \n\n    try {\n      const { images, totalHits: total } = await searchImages(query, page);\n      totalHits = total;\n      loadedHits = images.length;\n\n      if (images.length === 0) {\n        iziToast.info({\n          title: 'Info',\n          message: 'No images found.',\n          position: 'topRight',\n        });\n        return;\n      }\n\n      galleryList.innerHTML = generateGalleryMarkup(images);\n\n      if (lightbox) {\n        lightbox.refresh();\n      } else {\n        lightbox = new SimpleLightbox('.gallery__list a', {\n          captionsData: 'alt',\n          captionDelay: 250,\n        });\n      }\n\n      loadMoreButton.style.display = loadedHits < totalHits ? 'block' : 'none';\n\n      if (loadedHits >= totalHits) {\n        iziToast.info({\n          title: 'Info',\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    } catch (error) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Something went wrong with the search request.',\n        position: 'topRight',\n      });\n    } finally {\n      stopLoader();  \n    }\n  };\n\n  \n  searchForm.addEventListener(\"submit\", (event) => {\n    event.preventDefault();\n    query = searchInput.value.trim();\n\n    if (query === '') {\n      iziToast.error({\n        title: 'Error',\n        message: 'Fill search input!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    \n    galleryList.innerHTML = '';\n    page = 1;\n    loadedHits = 0;\n    loadMoreButton.style.display = 'none';\n\n    handleSearchImages();\n  });\n\n  \n  loadMoreButton.addEventListener(\"click\", async (event) => {\n    event.preventDefault();\n    page += 1;\n    startLoader();  \n\n    try {\n      const { images } = await loadMoreImages(query, page);\n      loadedHits += images.length;\n      galleryList.insertAdjacentHTML('beforeend', generateGalleryMarkup(images));\n\n      lightbox.refresh();\n      smoothScrollToNewImages();\n\n      loadMoreButton.style.display = loadedHits < totalHits ? 'block' : 'none';\n\n      if (loadedHits >= totalHits) {\n        iziToast.info({\n          title: 'Info',\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    } catch (error) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Failed to load more images.',\n        position: 'topRight',\n      });\n    } finally {\n      stopLoader();  \n    }\n  });\n\n  \n  function smoothScrollToNewImages() {\n    const { height: cardHeight } = galleryList.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n});\n"],"names":["API_KEY","BASE_URL","searchImages","query","page","response","axios","hits","totalHits","error","loadMoreImages","generateGalleryMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","startLoader","stopLoader","searchForm","searchInput","galleryList","loadMoreButton","lightbox","loadedHits","handleSearchImages","total","iziToast","SimpleLightbox","event","smoothScrollToNewImages","cardHeight"],"mappings":"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"}